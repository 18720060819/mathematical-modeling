%lin.m   利用MATLAB自带的优化工具箱求解
clc
%各科目各课程的均价
jsj=[25.8 25.5 28.0 26.0 24.7 25.6 27.0 22.9 25.9 24.5];
jg=[26.4 27.3 24.9 27.5 23.5 23.5 25.7 32.9 31.5 35.3];
sx=[21.0 20.2 24.8 19.6 18.6 23.3 13.1 18.4 22.5 25.7];
yy=[34.4 18.7 33.0 20.6 27.9 21.4 11.4 31.3 23.5 32.3];
lk=[14.7 18.8 26.6 16.7 13.4 14.8 17.5 24.2];
jn=[22.5 32.3 20.8 21.6 23.0 35.4];
hg=[20.0 23.6 25.6 28.0 18.9 26.7];
dl=[21.5 32.4 24.0 23.8 18.2 22.7];
hj=[37.5 22.2 20.7 22.7 24.3 32.2];
%各课程的书号个数百分比
w1=[0.159090909 0.161931818 0.039772727 0.048295455 0.048295455 0.153409091 0.122159091 0.048295455 0.147727273 0.071022727];
w2=[0.135678392 0.08040201 0.090452261 0.070351759 0.090452261 0.090452261 0.095477387 0.16080402 0.095477387 0.090452261];
w3=[0.044354839 0.173387097 0.239247312 0.036290323 0.120967742 0.143817204 0.059139785 0.024193548 0.102150538 0.056451613];
w4=[0.355971897 0.044496487 0.016393443 0.18969555 0.06088993 0.121779859 0.049180328 0.044496487 0.072599532 0.044496487];
w5=[0.065789474 0.149122807 0.105263158 0.157894737 0.074561404 0.140350877 0.157894737 0.149122807];
w6=[0.296482412 0.060301508 0.110552764 0.27638191 0.100502513 0.155778894];
w7=[0.076190476 0.152380952 0.2 0.123809524 0.123809524 0.323809524];
w8=[0.175 0.183333333 0.191666667 0.216666667 0.116666667 0.116666667];
w9=[0.174603175 0.238095238 0.222222222 0.214285714 0.087301587 0.063492063];
c1=[249.4166666 363.8375 118.3333333 238.4375 162.4166667 276.5818181 503.5486111 83.08333333 387.975 414.9375];
c2=[1425.5 1875.75 386.6666666 1106.208333 286.4166667 544.9166667 812.9375 575.2916666 2589.9375 1356.0625];
c3=[746.5416667 847.3785714 8609.903374 1297.5 1462.357843 2617.573864 628.4214286 498.8125 465.6760417 2863.553572];
c4=[747.8024039 525.45 907.9166667 268.5805555 447.8583334 274.1125 59.91666667 632.3875 347.4464286 301.8333333];
c5=[5297.5625 7532.660714 8622.2 4606.104167 16071.85416 7891.25 4104.633929 1241.875];
c6=[681.3461539 266.875 480.25 816.175 1204.683334 1000.75];
c7=[1038.75 863.95 406.975 162.9166667 782.0833333 427.4583333];
c8=[226.6666667 644.875 600.125 810.5 295.1666667 1543.666666];
c9=[593.1875 476.7916667 629.1666666 414.25 718.625 1460.75];
m=0.7;
ys=-[sum(jsj.*w1.*c1) sum(jg.*w2.*c2) sum(sx.*w3.*c3) sum(yy.*w4.*c4) sum(lk.*w5.*c5) sum(jn.*w6.*c6) sum(hg.*w7.*c7) sum(dl.*w8.*c8) sum(hj.*w9.*c9)];
y1=m*ys;
my=[3.25 3.24 3.24 3.24 3.2 3.2 3.3 3.27 3.2]; %满意度
pf=0.2*sin(pi/4*(my-2));
y2=(1-m)*pf.*ys;
y=y1+y2;
Aeq=[1 1 1 1 1 1 1 1 1];
beq=500;
A=[];b=[];
vlb=[70 35 145 78 40 38 17 21 21];
vub=[78 44 155 90 50 42 25 27 27];
j=[64   69  77  69  73
37  39  43  39  41
147 148 153 150 146
95  87  77  83  85
44  48  42  50  44
40  42  40  38  39
24  25  20  17  19
22  21  23  27  27
27  21  25  27  26];
qn=y*j;    %01-05年的经济总值
[x,fval]=linprog(y,A,b,Aeq,beq,vlb,vub) %x为06年书号分配方案，fval为相应的经济总值
